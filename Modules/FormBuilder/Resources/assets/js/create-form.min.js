jQuery(function(){$("#visibility").change(function(a){a.preventDefault();var b=$(this);""==b.val()||"PUBLIC"==b.val()?$("#allows_edit_DIV").hide():($("#allows_edit_DIV").slideDown(),$("#allows_edit").val("0"))});var a,b=$(document.getElementById("fb-editor")),c={dataType:"json",formData:window._form_builder_content?window._form_builder_content:"",controlOrder:["header","paragraph","text","textarea","select","number","date","autocomplete","file"],disableFields:["button"],disabledAttrs:[],typeUserDisabledAttrs:{file:["multiple","subtype"],"checkbox-group":["other"]},showActionButtons:!1,disabledActionButtons:["data"],sortableControls:!1,editOnAdd:!1,fieldRemoveWarn:!1,roles:window.FormBuilder.form_roles||{},notify:{error:function(a){return swal("Error",a,"error")},success:function(a){return swal("Success",a,"success")},warning:function(a){return swal("Warning",a,"warning")}},onSave:function(){}};a=b.formBuilder(c);var d=$(".fb-clear-btn"),e=$(".fb-showdata-btn"),f=$(".fb-save-btn");d.click(function(b){b.preventDefault();a.actions.getData().length&&sConfirm(jsLang("Are you sure you want to clear all fields from the form?"),function(){a.actions.clearFields()})}),e.click(function(b){b.preventDefault(),a.actions.showData()}),f.click(function(b){b.preventDefault();var c=$("#createFormForm");return c.parsley().validate()?a.actions.getData().length?void sConfirm("Save this form definition?",function(){f.attr("disabled","disabled"),d.attr("disabled","disabled");var b=a.actions.getData("json"),e={name:$("#name").val(),visibility:$("#visibility").val(),allows_edit:$("#allows_edit").val(),type:$("#type").val(),form_builder_json:b,_token:window.FormBuilder.csrfToken},g=c.data("formMethod")?"PUT":"POST";jQuery.ajax({url:c.attr("action"),processData:!0,data:e,method:g,cache:!1}).then(function(a){f.removeAttr("disabled"),d.removeAttr("disabled"),a.success?(swal({title:jsLang("Form Saved!"),text:a.details||"",icon:"success"}),setTimeout(function(){window.location=a.dest},1500)):swal({title:jsLang("Error"),text:a.details||jsLang("Error"),icon:"error"})},function(a){handleAjaxError(a),f.removeAttr("disabled"),d.removeAttr("disabled")})}):void swal({title:"Error",text:jsLang("The form builder cannot be empty"),icon:"error"}):void 0}),$("#fb-editor-footer").slideDown()});
