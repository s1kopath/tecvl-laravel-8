"use strict";var currentImageInput;$(document).on("click","#image-status",function(){$("#exampleModalCenter").modal("show"),currentImageInput=this}),$("#exampleModalCenter").on("show.bs.modal",function(a){$("#file-id").val($(a.relatedTarget).attr("id")),$("#file-name").val($(a.relatedTarget).attr("name")),$("#file-type").val($(a.relatedTarget).attr("type")),$("#file-size").val($(a.relatedTarget).attr("size")),$("#uploded-by").val($(a.relatedTarget).attr("user")),$("#uploded-date").val($(a.relatedTarget).attr("time")),$(".page-link").addClass("modal-paginator")}),$(".main-body .page-wrapper").find("#exampleModalCenter").length&&$(document).ready(function(){$(".pagination li a").addClass("custom-paginator")});let images=[];const image_show=()=>{let a="";return images.forEach(b=>{a+=`<div class="image_container d-flex flex-column justify-content-center align-items-start position-relative m-3">
              <img src= ${b.url} alt="Image">
              <p class="m-1">${b.name.slice(0,15).split(".")[0]+"."+b.file.type.split("/")[1]}</p>
              <small class="ml-1">${(.001*b.size).toFixed(2)} kb</small>
              <span class="position-absolute rounded-circle text-center img-remove-icon img-del" onclick="delete_image(${images.indexOf(b)})">&times;</span>
          </div>`}),a},delete_image=a=>{2>images.length&&addFiles(),images.splice(a,1),document.getElementById("img-container").innerHTML=image_show()},addFiles=()=>{$("#add-files").css("display","flex"),$("#add-more-files").addClass("add-more-files")},check_duplicate=a=>{let b=!0;if(0<images.length)for(let c of images)if(c.name===a){b=!1;break}return b};$(document).on("click","#clear-items",function(){addFiles(),images=[],image_show(),removeAllChildNodes(document.getElementById("img-container"))});function removeAllChildNodes(a){for(;a.firstChild;)a.removeChild(a.firstChild)}$(document).on("click",".img-remove-icon",function(){$(this).parent().hide()}),$(document).on("click",".close",function(){$(".item-border").remove()}),$(document).on("click",".modal-img-des",function(){"single"==$.trim($("#image-status").attr("data-val"))?($(".modal-img-des").each(function(){$(this).removeClass("item-border")}),$(this).toggleClass("item-border")):$(this).toggleClass("item-border");var a=$(".item-border").length;$("#add-file-count").text(a)}),$(document).on("click",".modal-img-des",function(){$(".btn-file-add").attr("data-info",$(this).find("img").attr("src").split(".").pop()),$(".btn-file-add").attr("data-size",$(this).find("small").text().split(" ").shift())}),$("#clear-item").click(function(){$(".modal-img-des").removeClass("item-border"),$("#add-file-count").text(0)}),$("#select-file").click(function(){$("#select-items").show(),$("#browse-file").hide(),$("#file-count").show(),$("#upload-card-header").show(),$(this).addClass("modal-title-color"),$("#upload-new").removeClass("modal-title-color"),$("#clear-items").hide(),fetch_data(1)}),$("#upload-new").click(function(){$("#select-items").hide(),$("#upload-card-header").hide(),$("#file-count").hide(),$("#browse-file").show(),$(this).addClass("modal-title-color"),$("#select-file").removeClass("modal-title-color"),$("#clear-items").removeClass("d-none"),$("#clear-items").show()}),$(".btn-file-add").click(function(){$("#exampleModalCenter").modal("hide"),getImages()});function getImages(){$("#img-container").html("");var a=[];$(".item-border").each(function(){a.push($(this).attr("id"))}),$.ajax({type:"POST",dataType:"html",url:SITE_URL+"/upload/image",data:{file_id:a,_token:token},success:function(b){"ids"==currentImageInput.dataset.returntype?(currentImageInput.querySelector(".is-image").setCustomValidity(""),currentImageInput.querySelector(".custom-file-input").value=a[0],$(currentImageInput.closest(".form-group")).find(".preview-image").html(b),currentImageInput.querySelector("label.error")&&currentImageInput.querySelector("label.error").remove()):$("#img-container").append(b)}})}$(document).on("click",".modal-paginator",function(a){a.preventDefault();var b=$(this).attr("href").split("page=")[1];fetch_data(b)});function fetch_data(a){$.ajax({url:SITE_URL+"/paginate-data?page="+a,method:"POST",data:{sort:$(this).val(),_token:token},success:function(a){$("#modal-img-des-container").html(a),$("#load-data").html($("#modal-id").html()),$(".pagination li a").addClass("modal-paginator")}})}$(document).on("change",".sort-option",function(){$("#media-list").submit(),$.ajax({type:"get",dataType:"html",url:SITE_URL+"/uploaded-files",data:{sort:$(this).val(),_token:token},success:function(a){$("#blog-image").append(a)}})}),$(document).on("change",".sort-option-modal",function(){$.ajax({type:"get",dataType:"html",url:SITE_URL+"/sort-files",data:{sort_value:$(this).val(),_token:token},success:function(a){$("#select-items").html(""),$("#select-items").append(a)}})}),$(document).on("keyup",".search-image",function(){$.ajax({type:"get",dataType:"html",url:SITE_URL+"/sort-files",data:{sort_name:$(this).val(),_token:token},success:function(a){$("#select-items").html(""),$("#select-items").append(a)}})});function getMaxFileId(){$.ajax({type:"get",dataType:"json",url:SITE_URL+"/max-fileid",data:{_token:token},success:function(a){return a}})}$(document).on("click",".btn-next",function(){var a="undefined"==typeof $(".modal-img-des").last().attr("id")?0:$(".modal-img-des").last().attr("id");$.ajax({type:"get",dataType:"html",url:SITE_URL+"/paginate-files",data:{next_file_id:a,_token:token},success:function(a){$("#select-items").html(""),$("#select-items").append(a)}})}),$(document).on("click",".btn-prev",function(){var a="undefined"==typeof $(".modal-img-des").last().attr("id")?getMaxFileId():$(".modal-img-des").last().attr("id");$.ajax({type:"get",dataType:"html",url:SITE_URL+"/paginate-files",data:{previous_file_id:a,_token:token},success:function(a){$("#select-items").html(""),$("#select-items").append(a)}})}),$(document).on("click",".copy-link",function(){navigator.clipboard.writeText($(this).attr("data-url")),swal(jsLang("Link copied to clipboard"),{icon:"success",buttons:[!1,jsLang("Ok")]})}),$(document).on("click",".delete-image",function(){swal({title:jsLang("Are you sure?"),icon:"warning",buttons:[jsLang("Cancel"),jsLang("Ok")],dangerMode:!0}).then(a=>{a&&$.ajax({dataType:"json",data:{id:$(this).attr("data-id"),_token:token},url:SITE_URL+"/delete-image",type:"POST",success:function(a){"success"==a.resp?swal(jsLang("Successfully deleted."),{icon:"success",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()}):swal(jsLang("Something went wrong"),{icon:"error",buttons:[!1,jsLang("Ok")]})}})})});