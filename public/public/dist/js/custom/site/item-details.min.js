"use strict";if($(".main-body .page-wrapper").find("#item-details-container").length){var ratingValue=0,mainPrice=$("#item_price").text().replace(/,/g,""),optionIdentify=[],amount=[],count=0,tempAmount=0,multipleSelectPrice=[],multipleSelectPriceType=[],globalOptionBox=[],lastOptionBox=null,rateClickEnable=!1;function getStock(e,t,a){$.ajax({url:SITE_URL+"/get-stock",data:{item_option_id:e,option_label:t,_token:token},type:"POST",dataType:"JSON",success:function(t){if(1==t.status)if(1==t.is_track_inventory){t.quantity>0?enableAddToCart(e):disableAddToCart();let i="";"0"==t.is_hide_stock&&(i=jsLang("Stock left")+": "+getDecimalNumberFormat(t.quantity)),$("#stock_qty-"+a).removeClass("display-none"),$("#stock_qty-"+a).text(i)}else enableAddToCart(e);else enableAddToCart(e)}})}function enableAddToCart(e){let t=[];$.each($(".option_price"),function(e,a){t[e]=void 0!==$(this).find(":selected").attr("data-optionRealId")?$(this).find(":selected").attr("data-optionRealId"):$(this).attr("data-optionRealId")}),jQuery.inArray(e,t)||($("#item-add-to-cart").addClass("add-to-cart"),$("#item-add-to-cart").removeClass("disable_a_href"))}function disableAddToCart(){$("#item-add-to-cart").removeClass("add-to-cart"),$("#item-add-to-cart").addClass("disable_a_href")}function changePrice(e,t,a,i,s,o=null){let n=null;if(void 0===e&&void 0!==amount[a])null!=o?(amount[a]-=o,n=multipleCalc(".customCheckBox-"+a,s),amount[a]=n.extra,tempAmount=calculate()+mainPrice,$("#item_price").text(null),$("#item_price").text(getDecimalNumberFormat(tempAmount))):($("#item_price").text(null),$("#item_price").text(getDecimalNumberFormat(tempAmount-amount[a])),delete amount[a]);else{e=parseFloat(e),mainPrice=parseFloat(mainPrice);let i=0;i="Percent"==t?mainPrice*e/100:e,"checkbox_custom"==s||"multiple_select"==s||"radio_custom"==s?(n=multipleCalc("checkbox_custom"==s||"radio_custom"==s?".customCheckBox-"+a:"#multiple-"+a,s),amount[a]=n.extra,tempAmount=calculate()+mainPrice):(amount[a]=i,tempAmount=calculate()+mainPrice),$("#item_price").text(null),$("#item_price").text(getDecimalNumberFormat(tempAmount))}}function multipleCalc(e,t){let a,i,s=0,o=0;if("multiple_select"==t)a=multipleSelectPrice,i=multipleSelectPriceType;else{let t=[],s=[];$(e+":checkbox:checked").each(function(e){t[e]=$(this).attr("data-price"),s[e]=$(this).attr("data-type")}),a=t,i=s}return $.each(a,function(e,t){"Percent"==i[e]?o+=mainPrice*parseFloat(t)/100:o+=parseFloat(t),s+=mainPrice}),{total:s,extra:o}}function calculate(){let e=0;for(let t=0;t<amount.length;t++)void 0!==amount[t]&&(e+=amount[t]);return e}function removeArrayElement(e,t){"relate"==e?delete preVDuplicateRelate[t]:"cross"==e?delete preVDuplicateCross[t]:"up"==e&&delete preVDuplicateUp[t]}$(document).ready(function(){$("#stars li").on("mouseover",function(){var e=parseInt($(this).data("value"),10);$(this).parent().children("li.star").each(function(t){t<e?$(this).addClass("hover"):$(this).removeClass("hover")})}).on("mouseout",function(){$(this).parent().children("li.star").each(function(e){$(this).removeClass("hover")})}),$(document).on("click","#stars li",function(){var e=parseInt($(this).data("value"),10),t=$(this).parent().children("li.star");for(let e=0;e<t.length;e++)$(t[e]).removeClass("selected");for(let a=0;a<e;a++)$(t[a]).addClass("selected");ratingValue=parseInt($("#stars li.selected").last().data("value"),10),rateClickEnable=!0})}),$(".singleCheckBox").on("click",function(){let e=$(this).attr("data-optionId"),t=$(this).attr("data-option");$(".multiChk-"+t).each(function(){$(this).attr("data-optionId")!=e&&$(this).prop("checked",!1)})}),$(document).on("change",".option_price",function(){let e,t,a,i,s,o;s=void 0!==$(this).find(":selected").attr("data-inputType")?$(this).find(":selected").attr("data-inputType"):$(this).attr("data-inputType"),i=void 0!==$(this).find(":selected").attr("data-option")?$(this).find(":selected").attr("data-option"):$(this).attr("data-option"),$("#required-msg-"+i).addClass("display-none"),"checkbox"==s||"checkbox_custom"==s||"radio"==s||"radio_custom"==s?$(this).prop("checked")?changePrice(e=void 0!==$(this).find(":selected").attr("data-price")?$(this).find(":selected").attr("data-price"):$(this).attr("data-price"),t=void 0!==$(this).find(":selected").attr("data-type")?$(this).find(":selected").attr("data-type"):$(this).attr("data-type"),i,a=void 0!==$(this).find(":selected").attr("data-optionId")?$(this).find(":selected").attr("data-optionId"):$(this).attr("data-optionId"),s):(o=null,$(this).prop("checked",!1)&&(o=void 0!==$(this).find(":selected").attr("data-price")?$(this).find(":selected").attr("data-price"):$(this).attr("data-price")),changePrice(e,t,i,a,s,o)):changePrice(e=void 0!==$(this).find(":selected").attr("data-price")?$(this).find(":selected").attr("data-price"):$(this).attr("data-price"),t=void 0!==$(this).find(":selected").attr("data-type")?$(this).find(":selected").attr("data-type"):$(this).attr("data-type"),i,a=void 0!==$(this).find(":selected").attr("data-optionId")?$(this).find(":selected").attr("data-optionId"):$(this).attr("data-optionId"),s),$(this).prop("checked")||""!=$(this).find(":selected").val()?($(this).prop("checked")||$("#stock_qty-"+i).addClass("display-none"),(void 0!==$(this).find(":selected").val()||$(this).prop("checked"))&&getStock(void 0!==$(this).find(":selected").attr("data-optionRealId")?$(this).find(":selected").attr("data-optionRealId"):$(this).attr("data-optionRealId"),void 0!==$(this).find(":selected").val()?$(this).find(":selected").val():$(this).val(),i)):$("#stock_qty-"+i).addClass("display-none")}),$(document).on("click",".image-thumbnail",function(){var e=$(this).data("src");$(".preview-image img").attr("src",e),$(".preview-body").show(),$(".preview-body").animate({opacity:"1"},"slow")}),$(document).on("click",".preview-image span",function(){$(".preview-body").animate({opacity:"0"},"slow"),setTimeout(()=>{$(".preview-body").hide()},1e3)});$(".multiple_select").each(function(){let e=$(this).attr("id");window.dropdown=function(){return{options:[],selected:[],show:!1,open(){this.show=!0},close(){this.show=!1},isOpen(){return!0===this.show},select(e,t){this.options[e].selected?(this.selected.splice(this.selected.lastIndexOf(e),1),this.options[e].selected=!1):(this.options[e].selected=!0,this.options[e].element=t.target,this.selected.push(e))},remove(e,t){let a;this.options[t].selected=!1,this.selected.splice(e,1),multipleSelectPrice.splice(e,1),multipleSelectPriceType.splice(e,1),null!=(a=1==multipleSelectPrice.length?globalOptionBox[0]:null)&&(lastOptionBox=a),globalOptionBox.splice(e,1),0==multipleSelectPrice.length&&changePrice(null,null,lastOptionBox,null,"multiple_select")},loadOptions(){const t=document.getElementById(e).options;for(let e=0;e<t.length;e++)this.options.push({value:t[e].value,text:t[e].innerText,price:t[e].getAttribute("data-price"),inputType:t[e].getAttribute("data-inputType"),optionBox:t[e].getAttribute("data-option"),priceType:t[e].getAttribute("data-type"),optionId:t[e].getAttribute("data-optionId"),selected:null!=t[e].getAttribute("selected")&&t[e].getAttribute("selected")})},selectedValues(){let e=0;return this.selected.map(t=>(multipleSelectPrice[e]=this.options[t].price,multipleSelectPriceType[e]=this.options[t].priceType,globalOptionBox[e]=this.options[t].optionBox,changePrice(this.options[t].price,this.options[t].priceType,this.options[t].optionBox,this.options[t].optionId,this.options[t].inputType),e++,this.options[t].value))}}}});var gImgObj=[],j=0,k=0,deletedFiles=[];function fetch_data(e){var t=token,a=reviewUrl,i=itemId;return $.ajax({url:a,method:"POST",data:{_token:t,page:e,item_id:i},success:function(e){$("#load_review").html(e),$("span span.text-gray-500").css("background","#eee")}}),1}function validate(){for(var e=document.getElementById("image"),t=0;t<e.files.length;t++){var a=e.files[t];if(!allowExtension.includes(a.name.split(".").pop()))return!1;if(a.size>2048e3)return 2}return!0}$(document).on("change","#image",function(e){if(!validate())return $("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang("Please upload valid images")+"</span>"),$("#image").val(""),$(".error").remove(),0;if(2==validate())return $("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang("Maximum file size 2MB")+"</span>"),$("#image").val(""),$(".error").remove(),0;$("#message").hide(200),$(".error").remove();for(var t=e.target.files,a=t.length,i=0;i<a;i++){var s=t[i];gImgObj[k++]=s.name;var o=new FileReader;o.onload=function(e){$("#imgs").append(`\n                    <div class="pip error">\n                        <div class="relative inline-block">\n                            <img class="imageThumb object-cover h-24 w-24 border-2" src="${e.target.result}"/>\n                            <span data-id="${j++}" class="removes absolute rounded-full bg-red-200 px-2 cursor-pointer -top-3 -right-3 text-bold text-red-700">x</span>\n                        </div>\n                    </div>\n                `)},o.readAsDataURL(s)}}),$(document).on("click",".removes",function(){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(e=>{if(e.isConfirmed){var t=$(this).data("id");$(this).closest(".pip").remove(),void 0!==t&&(deletedFiles.push(gImgObj[t]),$("#deleted-files").val(deletedFiles))}})}),$("#view-more").css("background","linear-gradient(0deg, rgba(255,255,255,1) 0%, rgba(255,255,255,1) 65%, rgba(255,255,255,0) 100%)"),$("#view-more span").click(function(){$(".item-full-details").find(".add").length?($(".item-full-details").addClass("h-full"),$(".item-full-details").removeClass("h-96"),$("#view-more").addClass("remove"),$("#view-more svg").addClass("rotated-view"),$("#view-more").removeClass("add"),$("#view-more span").text(jsLang("See Less"))):($("#item-details-section")[0].scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),$(".item-full-details").removeClass("h-full"),$(".item-full-details").addClass("h-96"),$("#view-more").removeClass("remove"),$("#view-more svg").removeClass("rotated-view"),$("#view-more").addClass("add"),$("#view-more span").text(jsLang("See More")),setTimeout(()=>{$(document).scrollTop($(document).scrollTop()-100)},1e3))}),$("#view-more-policy").css("background","linear-gradient(0deg, rgba(255,255,255,1) 0%, rgba(255,255,255,1) 65%, rgba(255,255,255,0) 100%)"),$("#view-more-policy span").click(function(){$(".policy-full-details").find(".add").length?($(".policy-full-details").addClass("h-full"),$(".policy-full-details").removeClass("h-40"),$("#view-more-policy").addClass("remove"),$("#view-more-policy").removeClass("add"),$("#view-more-policy span").text(jsLang("See Less"))):($("#policy-details-section")[0].scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),$(".policy-full-details").removeClass("h-full"),$(".policy-full-details").addClass("h-40"),$("#view-more-policy").removeClass("remove"),$("#view-more-policy").addClass("add"),$("#view-more-policy span").text(jsLang("See More")),setTimeout(()=>{$(document).scrollTop($(document).scrollTop()-100)},1e3))}),$(".rating-width").each((e,t)=>{$(t).css("width",$(t).data("width")+"%")}),$("span span.text-gray-500").css("background","#eee"),$(document).on("click","span a",function(e){e.preventDefault(),fetch_data($(this).attr("href").split("page=")[1])}),$("#reviewFrom").on("submit",function(e){e.preventDefault();let t=ratingValue;if(0==t)$("#message").show(500).html('<span class="font-bold text-red-600">'+jsLang("Rating field is required")+"</span>");else{if($("#imgs").find(".pip").length>15)return $("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang("You can only upload a maximum of 15 files.")+"</span>"),0;{let e=$("#comments").val(),i=$("#item_id").val();var a=new FormData(this);a.append("rating",t),a.append("comments",e),a.append("item_id",i),$.ajax({url:SITE_URL+"/user/review-store",type:"POST",dataType:"JSON",data:a,contentType:!1,cache:!1,processData:!1,success:function(e){1==e.status?(setTimeout(()=>{$(".review-store-section").hide(500),fetch_data(1)},3e3),$("#imgs").html(""),$("#message").show(200),$("#message").html('<span class="font-bold text-green-600">'+jsLang(e.message)+"</span>"),$("#comments").val(null),$(".star").removeClass("selected"),deletedFiles=[],gImgObj=[],j=0,k=0):($("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang(e.message)+"</span>"))},error:function(e,t,a){401==e.status?($("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang("To give a review, you need to login first.")+"</span>")):($("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang(a)+"</span>"))}})}}setTimeout(()=>{$("#message").hide(500)},5e3)});var ratingUpdate=null;$(document).on("click","#stars li",function(){ratingUpdate=!0}),$(document).on("submit","#reviewUpdateFrom",function(e){if(e.preventDefault(),$("#imgs").find(".pip").length>15)return $("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang("You can only upload a maximum of 15 files.")+"</span>"),0;var t=new FormData(this);ratingUpdate&&t.append("rating",ratingValue),console.log(t),$.ajax({url:SITE_URL+"/site/review/update",type:"POST",dataType:"JSON",data:t,contentType:!1,cache:!1,processData:!1,success:function(e){if(1==e.status){deletedFiles=[],gImgObj=[],j=0,k=0;var t=Number($("span.relative.inline-flex.items-center.px-4.py-2.-ml-px").text());fetch_data(1e3)&&fetch_data(t),$("#imgs").hide(),$("#message").show(200),$("#message").html('<span class="font-bold text-green-600">'+jsLang(e.message)+"</span>"),setTimeout(()=>{fetch_data($("span.relative.inline-flex.items-center.px-4.py-2.-ml-px").text()),$("#message").hide(),$("#imgs").show()},2500)}else $("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang(e.message)+"</span>")},error:function(e,t,a){401==e.status?($("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang("To give a review, you need to login first.")+"</span>")):($("#message").show(200),$("#message").html('<span class="font-bold text-red-600">'+jsLang(a)+"</span>"))}})}),$(document).on("click",".remove-review-image",function(){var e=$(this).data("path"),t=$(this),a=$(this).data("key");Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(i=>{i.isConfirmed&&$.ajax({url:SITE_URL+"/site/review/destroy",data:{path:e,_token:token},type:"POST",dataType:"JSON",success:function(e){t.closest(".pip").hide(),$("body #review-image-"+a).hide()}})})}),$(document).on("click",".filter",function(){var e=$(this).data("star"),t=$(this).data("item");$(".filter").children().removeClass("text-green-500"),$(".filter span.text-md").addClass("ml-3"),$(".filter span.text-md").text(""),$(this).prepend('<span class="text-green-500 -mr-3 text-md">âœ“</span>'),$(this).children().addClass("text-green-500"),$.ajax({url:SITE_URL+"/site/review/filter",data:{rating:e,itemId:t,_token:token},type:"POST",success:function(e){$("#load_review").html(e)}})}),$("#rating").click(function(){$("#load_review")[0].scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})})}function Tabs(e){var t=document.querySelector(e.el),a=!1,i=t.querySelector(".c-tabs-nav"),s=t.querySelectorAll(".c-tabs-nav__link"),o=t.querySelectorAll(".c-tab"),n=!!e.marker&&function(){var e=document.createElement("div");return e.classList.add("c-tab-nav-marker"),i.appendChild(e),e}(),l=0;function r(e,t){e.addEventListener("click",function(e){e.preventDefault(),d(t)})}function d(e){e>=0&&e!=l&&e<=s.length&&(s[l].classList.remove("is-active"),s[e].classList.add("is-active"),o[l].classList.remove("is-active"),o[e].classList.add("is-active"),n&&c(s[e]),l=e)}function c(e){n.style.left=e.offsetLeft+"px",n.style.width=e.offsetWidth+"px"}return{init:function(){if(!a){a=!0;for(var e=0;e<s.length;e++)r(s[e],e);n&&c(s[l])}},goToTab:d}}var m=new Tabs({el:"#tabs",marker:!0});if(m.init(),setTimeout(()=>{$(".product-thumbs").css("opacity","1")},5),$(".product-left").length){var productSlider=new Swiper(".product-slider",{spaceBetween:0,centeredSlides:!0,loop:!0,direction:"horizontal",loopedSlides:6,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},resizeObserver:!0}),productThumbs=new Swiper(".product-thumbs",{spaceBetween:17,centeredSlides:!0,loop:!0,slideToClickedSlide:!0,direction:"horizontal",slidesPerView:"auto",loopedSlides:slideCounts});productSlider.controller.control=productThumbs,productThumbs.controller.control=productSlider}$(".zoom").mousemove(function(e){var t,a,i,s,o=e.currentTarget;t=e.offsetX?e.offsetX:e.touches[0].pageX,e.offsetY?a=e.offsetY:t=e.touches[0].pageX,i=t/o.offsetWidth*100,s=a/o.offsetHeight*100,o.style.backgroundPosition=i+"% "+s+"%"}),$("a.review").click(function(){$("a").removeClass("is-acive"),$(this).addClass("is-active"),$("div.c-tab").removeClass("is-active"),$("div.c-tab.review").addClass("is-active"),$(document).scrollTop($("#item-details-section").offset().top-100)}),$("a.review").trigger("click"),document.querySelector("#review-open-modal-btn").addEventListener("click",function(){document.querySelector("body").style.overflow="hidden"}),$(".review-close-modal-btn").click(function(){$("body").css("overflow","visible")});
